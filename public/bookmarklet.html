<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ë—É–∫–º–∞—Ä–∫–ª–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #5180e9;
            --secondary-color: #6c757d;
            --background-color: #f8f9fa;
            --border-color: #dee2e6;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            background-color: var(--background-color);
            color: #333;
            padding: 2rem;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: var(--primary-color);
            margin-bottom: 1.5rem;
        }
        
        h2 {
            margin-top: 2rem;
            color: #444;
        }
        
        .bookmarklet {
            display: inline-block;
            padding: 8px 16px;
            background-color: #007bff;
            color: white !important;
            text-decoration: none;
            border-radius: 4px;
            margin: 10px 0;
            font-weight: bold;
        }
        
        .bookmarklet:hover {
            background-color: #0069d9;
        }
        
        pre {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
        }
        
        code {
            white-space: pre-wrap;
            word-break: break-word;
        }
        
        .alert {
            border-radius: 4px;
        }
        
        .instruction-step {
            margin-bottom: 1.5rem;
            padding-left: 1rem;
            border-left: 3px solid var(--primary-color);
        }
        
        .instruction-step h3 {
            margin-bottom: 0.5rem;
        }
        
        .note {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 4px 4px 0;
        }
        
        img {
            max-width: 100%;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            margin: 1rem 0;
        }
    </style>
    <script>
        // –ö–æ–¥ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Ç–µ–ª–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', () => {
            const protocol = window.location.protocol;
            const host = window.location.host;
            
            const bookmarkletCodeBasic = `javascript:(function(){
                var s=document.createElement('script');
                s.src='${protocol}//${host}/client.js';
                document.body.appendChild(s);
            })()`;
            
            const bookmarkletCodeEnhanced = `javascript:(function(){
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–≥—Ä—É–∂–µ–Ω –ª–∏ —É–∂–µ
                if (window.WebMonitorInstance) {
                    alert('–°–∫—Ä–∏–ø—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω!');
                    return;
                }
                
                // –î–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–π –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏
                var notification = document.createElement('div');
                notification.style.cssText = 'position:fixed;top:10px;right:10px;background:rgba(0,0,0,0.7);color:white;padding:10px;border-radius:5px;z-index:999999;';
                notification.textContent = '–ó–∞–≥—Ä—É–∑–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞...';
                document.body.appendChild(notification);
                
                var s = document.createElement('script');
                s.src = '${protocol}//${host}/client.js';
                s.onload = function() {
                    notification.textContent = '–°–∫—Ä–∏–ø—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω!';
                    setTimeout(function() { notification.remove(); }, 3000);
                };
                s.onerror = function() {
                    notification.textContent = '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∫—Ä–∏–ø—Ç–∞! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å.';
                    notification.style.background = 'rgba(255,0,0,0.7)';
                    console.error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–∫—Ä–∏–ø—Ç —Å ${protocol}//${host}/client.js');
                };
                document.body.appendChild(s);
            })()`;
            
            const renderAdditionalCode = isHTTPS => {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ protocol –∏ host –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã
                if (!protocol || !host) {
                    return '–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.';
                }
                
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –±—É–∫–º–∞—Ä–∫–ª–µ—Ç
                document.getElementById('bookmarklet-link').href = bookmarkletCodeEnhanced;
                document.getElementById('bookmarklet-code').textContent = bookmarkletCodeEnhanced;
                
                // HTML –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
                return `
                    <div class="alert alert-info mt-3">
                        <strong>–£–ª—É—á—à–µ–Ω–Ω—ã–π –±—É–∫–º–∞—Ä–∫–ª–µ—Ç!</strong> –¢–µ–ø–µ—Ä—å —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫ –∏ –≤–∏–∑—É–∞–ª—å–Ω—ã–º–∏ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è–º–∏.
                    </div>
                    <div class="alert alert-success mt-3">
                        <h5>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:</h5>
                        <ol>
                            <li>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Å—Å—ã–ª–∫—É –≤ –∑–∞–∫–ª–∞–¥–∫–∏ –∏–ª–∏ –∫–ª–∏–∫–Ω–∏—Ç–µ –ø—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –∏ –≤—ã–±–µ—Ä–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å –≤ –∑–∞–∫–ª–∞–¥–∫–∏"</li>
                            <li>–ù–∞ –Ω—É–∂–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ —ç—Ç—É –∑–∞–∫–ª–∞–¥–∫—É</li>
                            <li>–í—ã —É–≤–∏–¥–∏—Ç–µ –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–æ—Ü–µ—Å—Å–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è</li>
                            <li>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ (F12), –µ—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –ø—Ä–æ–±–ª–µ–º—ã</li>
                        </ol>
                    </div>
                    <div class="alert alert-warning mt-3">
                        <h5>–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:</h5>
                        <ul>
                            <li><strong>Content Security Policy (CSP)</strong> - –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Å–∞–π—Ç—ã –±–ª–æ–∫–∏—Ä—É—é—Ç –∑–∞–≥—Ä—É–∑–∫—É –≤–Ω–µ—à–Ω–∏—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤</li>
                            <li><strong>CORS</strong> - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∫—Ä–æ—Å—Å-–¥–æ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤</li>
                            <li><strong>WebSocket –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω</strong> - –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è HTTP</li>
                        </ul>
                    </div>
                    <div class="alert alert-primary mt-3">
                        <h5>–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:</h5>
                        <p>–ï—Å–ª–∏ –±—É–∫–º–∞—Ä–∫–ª–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:</p>
                        <ol>
                            <li>–û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ (F12 ‚Üí Console)</li>
                            <li>–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö</li>
                            <li>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞ –ø–æ –∞–¥—Ä–µ—Å—É <a href="${protocol}//${host}/ws-test" target="_blank">${protocol}//${host}/ws-test</a></li>
                        </ol>
                    </div>
                `;
            };
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–¥–º–∏–Ω —Å—Å—ã–ª–∫—É
            const adminLink = document.getElementById('admin-link');
            if (adminLink) {
                adminLink.href = `${protocol}//${host}/admin.html`;
                adminLink.textContent = `${protocol}//${host}/admin.html`;
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
            const additionalInfo = document.getElementById('additional-info');
            if (additionalInfo) {
                additionalInfo.innerHTML = renderAdditionalCode(protocol === 'https:');
            }
        });
    </script>
</head>
<body>
    <div class="container py-5">
        <h1 class="mb-4">–ë—É–∫–º–∞—Ä–∫–ª–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤</h1>
        
        <div class="alert alert-primary">
            <p><strong>–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —ç—Ç–æ—Ç –±—É–∫–º–∞—Ä–∫–ª–µ—Ç –∏ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç–µ –µ–≥–æ –≤ –∑–∞–∫–ª–∞–¥–∫–∏:</strong></p>
            <a id="bookmarklet-link" class="bookmarklet" href="javascript:void(0)">–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–ª–∏–µ–Ω—Ç–∞ üìä</a>
        </div>
        
        <div class="card mb-4">
            <div class="card-header">
                –ö–æ–¥ –±—É–∫–º–∞—Ä–∫–ª–µ—Ç–∞
            </div>
            <div class="card-body">
                <pre><code id="bookmarklet-code">javascript:(function(){ /* –∫–æ–¥ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ */ })();</code></pre>
            </div>
        </div>
        
        <div class="card mb-4">
            <div class="card-header">
                –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
            </div>
            <div class="card-body">
                <ol>
                    <li>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –±—É–∫–º–∞—Ä–∫–ª–µ—Ç –≤ –ø–∞–Ω–µ–ª—å –∑–∞–∫–ª–∞–¥–æ–∫ –≤–∞—à–µ–≥–æ –±—Ä–∞—É–∑–µ—Ä–∞.</li>
                    <li>–û—Ç–∫—Ä–æ–π—Ç–µ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü—É, –∫–æ—Ç–æ—Ä—É—é —Ö–æ—Ç–∏—Ç–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å.</li>
                    <li>–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –±—É–∫–º–∞—Ä–∫–ª–µ—Ç, —á—Ç–æ–±—ã –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥.</li>
                    <li>–û—Ç–∫—Ä–æ–π—Ç–µ –ø–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–∞–Ω–Ω—ã—Ö: <a id="admin-link" href="#" target="_blank">–ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</a></li>
                </ol>
            </div>
        </div>
        
        <div id="additional-info">
            <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∑–¥–µ—Å—å -->
        </div>
        
        <div class="card mt-4">
            <div class="card-header">
                –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ WebSocket
            </div>
            <div class="card-body">
                <p>–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–∞—é—Ç –ø—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º, –≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å —Å—Ç—Ä–∞–Ω–∏—Ü–µ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ WebSocket:</p>
                <a href="ws-test.html" class="btn btn-primary" target="_blank">–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ WebSocket</a>
            </div>
        </div>
    </div>
    
    <footer class="text-center py-3 text-muted">
        <small>–ú–æ–Ω–∏—Ç–æ—Ä –∫–ª–∏–µ–Ω—Ç–æ–≤ &copy; 2023</small>
    </footer>
</body>
</html> 